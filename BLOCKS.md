## Карта блоков процесса (на основе sota_dslib.drawio)

### config.yaml
- **Назначение**: централизованная точка управления всем процессом — от типа задачи и набора метрик до стратегий разбиения, сэмплирования, калибровки и перечня моделей. Обеспечивает воспроизводимость запусков и единообразие настроек для всей команды.
- **Что на входе**: YAML-файл с настройками процесса и моделей.
- **Результат**: согласованный набор параметров, применённых на всех этапах; перечень моделей для обучения; именованные пути для артефактов и данных.

### SOTAModels(config)
- **Назначение**: оркестратор пайплайна. Управляет подготовкой данных, обучением выбранных моделей, расчётом метрик, выбором лидера и сохранением результатов. Служит единой точкой входа для запуска экспериментов.
- **Что на входе**: конфигурация процесса, пути к данным, списки признаков.
- **Результат**: обученные модели, сводные метрики, выбранная лучшая модель, сохранённые артефакты и краткая отчётность.

### train parquet file
- **Назначение**: основной набор данных для построения моделей и последующего разбиения на выборки. Является стандартом формата и структуры данных для всей линии экспериментов.
- **Что на входе**: путь к файлу в формате Parquet с признаками и целевой переменной.
- **Результат**: таблица данных, используемая для обучения, валидации и тестирования.

### valid parquet file
- **Назначение**: независимая отложенная выборка для контроля качества вне обучающей процедуры. Снижает риск переобучения и повышает доверие к результатам.
- **Что на входе**: путь к файлу в формате Parquet с той же структурой, что и обучающий набор.
- **Результат**: отдельная валидационная выборка для объективной оценки моделей.

### Sampling
- **Назначение**: управление объёмом и составом выборок. Позволяет ускорять итерации на подвыборках и балансировать классы при дисбалансе, сохраняя воспроизводимость и контроль качества.
- **Что на входе**: обучающая/валидационная выборки, параметры размера, балансировки и случайности.
- **Результат**: подвыборки требуемого размера и состава, готовые к обучению и оценке.

### _split_data (разделение на тестовую и трейновую выборку)
- **Назначение**: корректное разбиение данных на обучающие, тестовые и при необходимости валидационные части. Поддерживает стратификацию для стабильных и сравнимых оценок качества.
- **Что на входе**: полный набор данных и параметры долей/стратификации.
- **Результат**: согласованные выборки train/test/(valid) для последующих шагов.

### Train_models (обучает все модели из списка selected_models)
- **Назначение**: единообразный цикл обучения и первичной оценки для набора выбранных моделей. Обеспечивает сопоставимость результатов и фиксацию временных затрат.
- **Что на входе**: список моделей для запуска, подготовленные выборки, гиперпараметры и метрики.
- **Результат**: обученные экземпляры моделей, первичные метрики по каждой и измеренное время обучения.

### Models
- **Назначение**: библиотека алгоритмов для задач табличного машинного обучения с единым интерфейсом обучения, предсказаний и оценки. Обеспечивает взаимозаменяемость и быстрые сравнения подходов.
- **Что на входе**: подготовленные данные, списки признаков и категориальных признаков, гиперпараметры.
- **Результат**: обученные артефакты моделей, предсказания/вероятности и служебные результаты для отчётности.

#### CatBoost
- **Назначение**: градиентный бустинг, устойчивый к категориальным признакам и шуму; сильная база для табличных задач.
- **Что на входе**: обучающие выборки, признаки, гиперпараметры.
- **Результат**: обученная модель и предсказания/вероятности.

#### LightGBM
- **Назначение**: высокопроизводительный бустинг с хорошей масштабируемостью и качеством на больших табличных данных.
- **Что на входе**: обучающие выборки, признаки, гиперпараметры.
- **Результат**: обученная модель и предсказания/вероятности.

#### RandomForest
- **Назначение**: ансамбль деревьев как надёжный ориентир по качеству и интерпретируемости.
- **Что на входе**: обучающие выборки, признаки, гиперпараметры.
- **Результат**: обученная модель и предсказания.

#### LightAutoML
- **Назначение**: автоматизированный стек для быстрого получения сильной базовой модели с минимальной ручной настройкой.
- **Что на входе**: обучающие выборки, признаки, опции пресетов.
- **Результат**: обученная композиция и предсказания/вероятности.

#### XGBoost
- **Назначение**: промышленный стандарт бустинга с упором на качество и гибкость настройки.
- **Что на входе**: обучающие выборки, признаки, гиперпараметры.
- **Результат**: обученная модель и предсказания/вероятности.

#### TabNet
- **Назначение**: нейросетевая архитектура с механизмом внимания для табличных данных; уместна при сложных нелинейностях и больших объёмах данных.
- **Что на входе**: обучающие выборки, признаки, гиперпараметры и настройки устройства.
- **Результат**: обученная модель и предсказания/вероятности.

### Train, validation (на уровне моделей)
- **Назначение**: организация кросс-валидации или холд-аут проверки для устойчивых оценок качества и отбора гиперпараметров.
- **Что на входе**: обучающие и проверочные части данных, параметр количества фолдов/разбиений.
- **Результат**: обученные модели/фолды и метрики по каждому разбиению.

### Task type (Binary / Multiclass / Regression)
- **Назначение**: определяет постановку задачи, релевантные метрики и особенности подготовки/оценки. Позволяет единообразно поддерживать разные типы задач.
- **Что на входе**: тип задачи (бинарная, многоклассовая, регрессия).
- **Результат**: выбранные процедуры обучения и набор метрик, соответствующие типу задачи.

### Metrics (Binary / Multiclass / Regression)
- **Назначение**: стандартизованный расчёт качества и сводная отчётность по всем моделям. Обеспечивает сравнение, ранжирование и принятие решений.
- **Что на входе**: список метрик и их параметры, истинные значения и предсказания/вероятности.
- **Результат**: значения метрик по моделям и сводная таблица результатов.

### Калибровка для бинарной классификации (опционально)
- **Назначение**: приведение вероятностей к реальным частотам событий для улучшения качества бизнес-правил и порогов срабатывания.
- **Что на входе**: вероятности модели на проверочной части и выбранный метод калибровки.
- **Результат**: калибратор и откалиброванные вероятности при применении модели.

### Сохранение всех моделей и калибраторов
- **Назначение**: гарантирует воспроизводимость, переносимость и повторное использование результатов эксперимента. Формирует артефакты для интеграции и аудита.
- **Что на входе**: обученные модели, калибраторы, метрики и служебные данные.
- **Результат**: сохранённые артефакты и структура каталогов с моделями и отчётными материалами.

### Print_metrics (отображение выбранных метрик по всем моделям)
- **Назначение**: прозрачная и удобная для чтения сводка результатов, упрощающая сравнение моделей между собой.
- **Что на входе**: рассчитанные метрики всех моделей и время обучения.
- **Результат**: человекочитаемая таблица с результатами.

### Отчёт по лучшей модели
- **Назначение**: фиксация итогов эксперимента — определение лидирующей модели по ключевой метрике и представление результата заинтересованным сторонам.
- **Что на входе**: агрегированные метрики и выбранная ключевая метрика.
- **Результат**: объявление лучшей модели и её значения ключевой метрики, краткая сводка.


